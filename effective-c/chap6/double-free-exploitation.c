#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
    char *ptr1 = (char *)malloc(32);
    char *ptr2 = (char *)malloc(32);

    strcpy(ptr1, "Hello, world!");
    printf("ptr1: %s\n", ptr1);

    free(ptr1);  // First free
    free(ptr1);  // Double free (vulnerability!)

    // Allocate a new buffer
    char *ptr3 = (char *)malloc(32); // Might reuse ptr1's memory
    strcpy(ptr3, "Hacked!");         // Overwrite ptr1's memory location

    printf("ptr1 after reallocation: %s\n", ptr1);  // Potential exploitation

    free(ptr2);
    free(ptr3);
    return 0;
}

